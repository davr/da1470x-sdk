<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SmartSnippets DA1470x SDK: Brief Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SmartSnippets DA1470x SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Brief Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The project is used to generate SEGGER's Open Flashloader firmware. There are two (2) build configurations for each combination of device family and memory controller type:</p>
<ul>
<li>xxx-00_yyy_Debug_RAM</li>
<li>xxx-00_yyy_Release</li>
</ul>
<p>where:</p>
<ul>
<li>xxx: Device Family</li>
<li>yyy: Type of memory controller</li>
<li>QFLASH: Flash connected to Quad SPI controller</li>
<li>OQFLASH: Flash connected to Octa SPI controller</li>
<li>EFLASH: Embedded Flash</li>
</ul>
<p>The Debug build configuration allows to debug the flash algorithm during development. The configuration includes a <code>main.c</code> containing the typical function call order, executed by the J-Link DLL during flash programming. It behaves as a typical RAM build configuration.</p>
<p>The Release build configuration does not allow debugging yet creates the output <code>*.elf</code> file which can be referenced from within the JLinkDevices.xml file as "Loader".</p>
<p>For more info refer to <a href="https://wiki.segger.com/Open_Flashloader">Open Flashloader wiki page</a>.</p>
<h1><a class="anchor" id="autotoc_md116"></a>
Prerequisites</h1>
<ol type="1">
<li>Compile the Release build configuration of the corresponding device. Please note that DA1470X device family supports two flash devices, OQFLASH/QFLASH.</li>
<li>Make sure that the corresponding <code>segger_flash_loader.elf</code> files have been built under the paths:<ul>
<li>DA1469X:<ul>
<li>QFLASH: ~/sdk10/binaries/segger_flash_loader.elf</li>
</ul>
</li>
<li>DA1470X:<ul>
<li>OQFLASH: ~/sdk10/binaries/da1470x/oflash/segger_flash_loader.elf</li>
<li>QFLASH: ~/sdk10/binaries/da1470x/qflash/segger_flash_loader.elf</li>
</ul>
</li>
</ul>
</li>
<li>Make sure that an appropriate JLink version is installed and selected in Smart Snippets Studio.</li>
<li>Make sure that the valid XML Tags and Attributes have been added to the <br  />
 <code>JLinkDevices.xml</code> so that the SEGGER tools can use the <code>segger_flash_loader.elf</code> properly:<ul>
<li>~/sdk10/config/segger/DA1469x/JLinkDevices.xml</li>
<li>~/sdk10/config/segger/DA1470x/JLinkDevices.xml</li>
</ul>
</li>
</ol>
<p><b>DA1469x</b> </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">DataBase</span>&gt;</div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  <span class="comment">&lt;!-- DIALOG (DA1469x)--&gt;</span></div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">Device</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">ChipInfo</span> <span class="keyword">Vendor</span>=<span class="stringliteral">&quot;Dialog Semiconductor&quot;</span>   <span class="keyword">Name</span>=<span class="stringliteral">&quot;DA1469x&quot;</span> <span class="keyword">WorkRAMAddr</span>=<span class="stringliteral">&quot;0x810000&quot;</span> <span class="keyword">WorkRAMSize</span>=<span class="stringliteral">&quot;0x10000&quot;</span> <span class="keyword">Core</span>=<span class="stringliteral">&quot;JLINK_CORE_CORTEX_M33&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;MX25U3225F&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x36000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x2000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;../../../binaries/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Device</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">DataBase</span>&gt;</div>
</div><!-- fragment --><p> <b>DA1470x</b> </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">DataBase</span>&gt;</div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  <span class="comment">&lt;!-- DIALOG (DA1470x)--&gt;</span></div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">Device</span>&gt;</div>
<div class="line">    <span class="comment">&lt;!-- WorkRAM as declared in sections.ld --&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">ChipInfo</span> <span class="keyword">Vendor</span>=<span class="stringliteral">&quot;Dialog Semiconductor&quot;</span>   <span class="keyword">Name</span>=<span class="stringliteral">&quot;DA1470x&quot;</span> <span class="keyword">WorkRAMAddr</span>=<span class="stringliteral">&quot;0x10010000&quot;</span> <span class="keyword">WorkRAMSize</span>=<span class="stringliteral">&quot;0x00040000&quot;</span> <span class="keyword">Core</span>=<span class="stringliteral">&quot;JLINK_CORE_CORTEX_M33&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;OQSPIC Flash&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x38000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x8000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;../../../binaries/da1470x/oflash/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;QSPIC Flash&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x48000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x8000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;../../../binaries/da1470x/qflash/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Device</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">DataBase</span>&gt;</div>
</div><!-- fragment --><p> <em>Note: In fact only the first step is necessary to be done in order for the user to setup the SEGGER Flash loader. The steps 2 - 4 are useful just for validating that everything has been configured properly</em></p>
<h1><a class="anchor" id="autotoc_md117"></a>
Integrating JLinkDevices.xml on SDK</h1>
<p>For easier maintenance the SDK integrates the <code>JLinkDevices.xml</code> using the J-Link command <code>-JLinkDevicesXMLPath &lt;path to JLinkDevices.xml&gt;</code> according to <a href="https://forum.segger.com/index.php/Thread/4209-Add-a-new-flash-device-to-the-JLInkDevices-database/?postID=15141#post15141">SEGGER's suggestion</a>. This command allows a SmartSnippets launcher to flash a device by making use of <code>segger_flash_loader.elf</code> functionality.</p>
<p>The user can use one of the following launchers to flash and debug an application built for a non-volatile memory: </p><pre class="fragment">- DA1469X: 
    * There is no launcher for 69X family. Please, refer to the next section 
      `Setting up SEGGER J-Link tools` for this purpose. 
- DA1470X: 
    * OQFLASH: OQSPI_DA1470x_segger_flasher
    * QFLASH:  There is no launcher for the flash which is connected to QSPIC.
               Likewise with 69X family refer to the next section for this purpose.
</pre><p>To have a better understanding how the JLinkDevices.xml is integrated by a launcher open the <code>Debugger</code> Tab of one of them, for instance the <code>OQSPI_DA1470x_segger_flasher</code> and have a look at the field <code>Other options:</code> where the next attribute is included:</p>
<p><code>-JLinkDevicesXMLPath ${workspace_loc}/config/segger/DA1470x/JLinkDevices.xml</code></p>
<p><em>IMPORTANT NOTE</em></p>
<p>In order to build an application capable to be flashed with Segger Flash Loader it is necessary to define <code>dg_configUSE_SEGGER_FLASH_LOADER=1</code>. Otherwise the binary file will not include the corresponding product headers, image headers etc, causing the booter to get stuck and the application will not boot.</p>
<p>Moreover, keep in mind that, in case of DA1469X, the linker script is only applicable to the default flash memory, i.e. MX25U3225F. If you need to build an application for another memory, you need to modify the linker script so that the proper product headers etc. are included in the binary file. Otherwise, the application will not boot for the same reason as described above.</p>
<h1><a class="anchor" id="autotoc_md118"></a>
Setting up SEGGER J-Link tools</h1>
<p>An alternative to flash the non-volatile memories is by using the SEGGER J-Link Tools. To make that possible you need to follow the next steps, assuming that the SEGGER J-Link is installed under the path <code>C:\Program Files (x86)\SEGGER\JLink_V640</code>:</p>
<ul>
<li>Copy the corresponding <code>segger_flash_loader.elf</code> files under the following path:<ul>
<li>DA1469X:<ul>
<li>QFLASH: <code>C:\Program Files (x86)\SEGGER\JLink_V640\Devices\Dialog\da1469x\qflash\segger_flash_loader.elf</code></li>
</ul>
</li>
<li>DA1470X:<ul>
<li>OQFLASH: <code>C:\Program Files (x86)\SEGGER\JLink_V640\Devices\Dialog\da1470x\oflash\segger_flash_loader.elf</code></li>
<li>QFLASH: <code>C:\Program Files (x86)\SEGGER\JLink_V640\Devices\Dialog\da1470x\qflash\segger_flash_loader.elf</code></li>
</ul>
</li>
</ul>
</li>
<li>Update the <code>C:\Program Files (x86)\SEGGER\JLink_V640\JLinkDevices.xml</code> by adding the following between <code>&lt;DataBase&gt;</code> and <code>&lt;/DataBase&gt;</code></li>
</ul>
<p><b>DA1469x</b> </p><div class="fragment"><div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  <span class="comment">&lt;!-- DIALOG (DA1469x)--&gt;</span></div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">Device</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">ChipInfo</span> <span class="keyword">Vendor</span>=<span class="stringliteral">&quot;Dialog Semiconductor&quot;</span>   <span class="keyword">Name</span>=<span class="stringliteral">&quot;DA1469x&quot;</span> <span class="keyword">WorkRAMAddr</span>=<span class="stringliteral">&quot;0x810000&quot;</span> <span class="keyword">WorkRAMSize</span>=<span class="stringliteral">&quot;0x10000&quot;</span> <span class="keyword">Core</span>=<span class="stringliteral">&quot;JLINK_CORE_CORTEX_M33&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;MX25U3225F&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x36000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x2000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;Devices/Dialog/da1469x/qflash/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Device</span>&gt;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">__DA1470x__</span></div>
<div class="line">~~~~{.<span class="keyword">xml</span>}</div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  <span class="comment">&lt;!-- DIALOG (DA1470x)--&gt;</span></div>
<div class="line">  <span class="comment">&lt;!--                 --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">Device</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">ChipInfo</span> <span class="keyword">Vendor</span>=<span class="stringliteral">&quot;Dialog Semiconductor&quot;</span>   <span class="keyword">Name</span>=<span class="stringliteral">&quot;DA1470x&quot;</span> <span class="keyword">WorkRAMAddr</span>=<span class="stringliteral">&quot;0x10010000&quot;</span> <span class="keyword">WorkRAMSize</span>=<span class="stringliteral">&quot;0x00040000&quot;</span> <span class="keyword">Core</span>=<span class="stringliteral">&quot;JLINK_CORE_CORTEX_M33&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;Code Flash&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x38000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x8000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;Devices/Dialog/da1470x/oflash/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">FlashBankInfo</span> <span class="keyword">Name</span>=<span class="stringliteral">&quot;QSPIC1 (Storage Flash)&quot;</span> <span class="keyword">BaseAddr</span>=<span class="stringliteral">&quot;0x48000000&quot;</span> <span class="keyword">MaxSize</span>=<span class="stringliteral">&quot;0x8000000&quot;</span> <span class="keyword">Loader</span>=<span class="stringliteral">&quot;Devices/Dialog/da1470x/qflash/segger_flash_loader.elf&quot;</span> <span class="keyword">LoaderType</span>=<span class="stringliteral">&quot;FLASH_ALGO_TYPE_OPEN&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">Device</span>&gt;</div>
</div><!-- fragment --><ul>
<li>To verify quickly whether the setup configuration is valid you can flash a binary to a device using the <code>JFlashLite.exe</code>:<ul>
<li>Run <code>JFlashLite.exe</code></li>
<li>Choose Device, for instance DA1470X and press OK</li>
<li>Choose the binary file and set the <code>Prog. addr. (bin file only)</code> with the physical address of the memory you want to program, for instance if this is the OQSPI Flash of DA1470X set 0x38000000, if the QSPI Flash of DA1470X set 0x48000000 and so on, then press the button <code>Program Device</code> </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 9 2022 13:50:40 for SmartSnippets DA1470x SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
